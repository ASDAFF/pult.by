!function(t,s,e,a){"use strict";function f(){this.js_offers=null,this.options={classActive:"active",onevalue:"onevalue",treevalue:"treevalue",blockSku:".block-sku-detail-sku",blockSkuTitle:".block-sku-detail-sku-name .selection"}}f.prototype.all=function(t){this.js_offers=t,this.OffersAllEach()},f.prototype.one=function(t,s){this.js_offers={},this.js_offers[t]=s,this.OffersAllEach()},f.prototype.OffersAllEach=function(){var s=this;for(var e in s.js_offers){var a=[],f=[],r=t("#"+e),i=0,E=[];if(s.js_offers[e].OFFERS){for(var o in s.js_offers[e].OFFERS[s.js_offers[e].OFFER_SELECTED].TREE)f[o]=s.js_offers[e].OFFERS[s.js_offers[e].OFFER_SELECTED].TREE[o],E[i]=o,++i;i=-1;for(var n=0;n<E.length;n++)s.Each(++i,E,f,r,a,e)}}},f.prototype.Each=function(t,s,e,a,f,r){for(var i,E,o=this,n=0;n<o.js_offers[r].OFFERS.length;n++)if(i=!1,o.js_offers[r].OFFERS[n].TREE){E=0;for(var l in o.js_offers[r].OFFERS[n].TREE){if(0==E){var _=a.find("."+l+" li[data-"+o.options.onevalue+'="'+o.js_offers[r].OFFERS[n].TREE[l]+'"]');_.length&&(_.show(),o.js_offers[r].OFFER_SELECTED==n&&(_.addClass(o.options.classActive),o.SetTitleSkuHtml(_)))}if(o.js_offers[r].OFFERS[n].TREE[l]!=e[s[E]]||l!=s[E])break;if(t==E){i=!0;break}++E}if(i){E=0;for(var l in o.js_offers[r].OFFERS[n].TREE){var _=a.find("."+l+" li[data-"+o.options.onevalue+'="'+o.js_offers[r].OFFERS[n].TREE[l]+'"]');if(_.length&&(_.show(),o.js_offers[r].OFFER_SELECTED!=n||_.hasClass(o.options.classActive)||(_.addClass(o.options.classActive),o.SetTitleSkuHtml(_),s.length==E+1&&o.ProductHtml(a,r,o.js_offers[r].OFFER_SELECTED)),f[l]||(_.closest("."+l).show(),f[l]=!0)),t+1==E)break;++E}}}},f.prototype.SelectEach=function(t,s,e,a,f,r){for(var i,E,o=this,n=0;n<o.js_offers[f].OFFERS.length;n++)if(i=!1,o.js_offers[f].OFFERS[n].TREE){E=0;for(var l in o.js_offers[f].OFFERS[n].TREE){if(o.js_offers[f].OFFERS[n].TREE[l]!=e[s[E]])break;if(t==E){if(s.length-1==t){var _=0;for(var d in o.js_offers[f].OFFERS[n].TREE){if(_>t){e[d]=o.js_offers[f].OFFERS[n].TREE[d],s[_]=d,r[_]=n;break}++_}}r[t]=n,i=!0;break}++E}if(i){E=0;for(var l in o.js_offers[f].OFFERS[n].TREE){var S=a.find("."+l+" li[data-"+o.options.onevalue+'="'+o.js_offers[f].OFFERS[n].TREE[l]+'"]');if(S.length&&S.show(),t+1==E)break;++E}}}},f.prototype.OffersSelect=function(s,e){var a=this,f=[],r=t("#"+s),i=0,E=[],o=[];r.find(a.options.blockSku+" li."+a.options.classActive+"[data-"+a.options.onevalue+"]").each(function(s){var r=t(this).data(a.options.onevalue),i=t(this).data(a.options.treevalue);if(f["PROP_"+i]=r,E[s]="PROP_"+i,i==e)return!1}),i=-1;for(var n in a.js_offers[s].OFFERS[a.js_offers[s].OFFER_SELECTED].TREE)a.SelectEach(++i,E,f,r,s,o);for(var l=0;l<E.length;l++){var _=r.find("."+E[l]+" li[data-"+a.options.onevalue+'="'+f[E[l]]+'"]');a.SetTitleSkuHtml(_)}a.ProductHtml(r,s,o[E.length-1],!0)},f.prototype.inBasketParser=function(t,s){$in_basket&&0<parseInt($in_basket[s])?(t.removeClass("add2basket").addClass("add2basket_"+s).attr("title",t.data("inbasket")).children(".text").text(t.data("inbasket")),t.attr("href",t.data("basketurl"))):(t.addClass("add2basket").attr("title",t.data("outbasket")).children(".text").text(t.data("outbasket")),t.attr("href","#"))},f.prototype.SetTitleSkuHtml=function(t){var s=this;t.addClass(s.options.classActive),t.closest(s.options.blockSku).find(s.options.blockSkuTitle).text(t.data("title"))},f.prototype.ProductHtml=function(s,e,f,r){var i,E=this,o=E.js_offers[e].OFFERS[f],n=E.js_offers[e].VISUAL,l={Offers:E,offer:o,visual:n,MainID:e};if(s.trigger(i=t.Event("starthtml.offers",l)),!i.isDefaultPrevented()){if(o.PREVIEW_PICTURE?s.find("#"+n.PICT_ID).attr("src",o.PREVIEW_PICTURE.SRC):s.find("#"+n.PICT_ID).attr("src",E.js_offers[e].DEFAULT_PICTURE.PICTURE.SRC),o.PREVIEW_PICTURE_SECOND?s.find("#"+n.SECOND_PICT_ID).attr("src",o.PREVIEW_PICTURE_SECOND.SRC).show():o.PREVIEW_PICTURE?s.find("#"+n.SECOND_PICT_ID).attr("src",o.PREVIEW_PICTURE.SRC):E.js_offers[e].DEFAULT_PICTURE.PICTURE_SECOND?s.find("#"+n.SECOND_PICT_ID).attr("src",E.js_offers[e].DEFAULT_PICTURE.PICTURE_SECOND.SRC):s.find("#"+n.SECOND_PICT_ID).attr("src",E.js_offers[e].DEFAULT_PICTURE.PICTURE.SRC),o.DISPLAY_PROPERTIES&&0!==o.DISPLAY_PROPERTIES.length){var _="";for(var d in o.DISPLAY_PROPERTIES)_+="<dt>"+o.DISPLAY_PROPERTIES[d].NAME+"</dt>",_+="<dd>"+o.DISPLAY_PROPERTIES[d].VALUE+"</dd>";s.find("#"+n.DISPLAY_PROP_DIV).html(_).show()}else s.find("#"+n.DISPLAY_PROP_DIV).html("").hide();if(r&&s.find(".detail-product-images-photorama").hide(),s.find("#"+n.SLIDER_LIST_OF_ID+o.ID).show(),s.find("#"+n.PRICE_ID).html(o.PRICE.PRINT_DISCOUNT_VALUE,o.PRICE.CURRENCY),o.PRICE.DISCOUNT_VALUE<o.PRICE.VALUE)if(s.find("#"+n.OLD_PRICE_ID).html(o.PRICE.PRINT_VALUE).show().parent().addClass("old"),E.js_offers[e].SHOW_DISCOUNT_PERCENT)s.find("#"+n.SALES).show().find("span").html("-"+o.PRICE.DISCOUNT_DIFF_PERCENT+"%");else{var S=s.find("#"+n.SALES);S.show(),S.show().find("span").html(S.data("name"))}else s.find("#"+n.OLD_PRICE_ID).html("").hide().parent().removeClass("old"),s.find("#"+n.SALES).hide().find("span").html("");var R=s.find("#"+n.QUANTITY_MEASURE);R.length&&(0<parseFloat(o.STEP_QUANTITY)&&R.val(parseFloat(o.STEP_QUANTITY)).attr("step",parseFloat(o.STEP_QUANTITY)),o.CHECK_QUANTITY?(R.attr("data-check",!0),R.attr("data-max",o.MAX_QUANTITY)):R.attr("data-check",!1),s.find("#"+n.NAME_MEASURE).text(o.MEASURE)),o.CAN_BUY?(s.find("#"+n.BUY_ID).show(),s.find("#"+n.NOT_AVAILABLE_MESS).hide()):(s.find("#"+n.BUY_ID).hide(),s.find("#"+n.NOT_AVAILABLE_MESS).show());var I=s.find("#"+n.BUY_ID),T=[];I.attr("data-elementid",o.ID);var c=I.attr("class");if(c!==a){T=c.split(" ");for(var h=0;h<T.length;h++)if(T[h].indexOf("add2basket_")>-1){I.removeClass(T[h]);break}E.inBasketParser(I,o.ID),I.addClass("add2basket_"+o.ID)}if(0<parseFloat(o.MAX_QUANTITY)){var O=s.find("#"+n.AVAILABLE_ID);O.text(O.data("in")).removeClass("text-danger").addClass("text-success")}else{var O=s.find("#"+n.AVAILABLE_ID);O.text(O.data("not")).removeClass("text-success").addClass("text-danger")}if(E.js_offers[e].STORES){var C=s.find("#"+n.STORES_ID);if(C.length){var P={};P=E.js_offers[e].STORES;for(var v in P.STORES)if(P.USE_MIN_AMOUNT){var F="";F=0==P.SKU[o.ID][P.STORES[v]]?P.MESSAGES.ABSENT:parseFloat(P.SKU[o.ID][P.STORES[v]])>=P.MIN_AMOUNT?P.MESSAGES.LOT_OF_GOOD:P.MESSAGES.NOT_MUCH_GOOD,C.find("#"+P.ID+"_"+P.STORES[v]).html(F)}else C.find("#"+P.ID+"_"+P.STORES[v]).html(P.SKU[o.ID][P.STORES[v]])}}r&&s.find(".constructor").hide(),s.find("#"+n.OFFER_GROUP+o.ID).show(),s.trigger(t.Event("endhtml.offers",l))}},s.Offers=new f}(window.jQuery,window,document),$(document).ready(function(){Offers.all(JS_OFFERS),$(document).on("click",".block-sku li",function(){var t=$(this).parents(".js-item").attr("id"),s=$(this).data("treevalue");return!(!t||$(this).hasClass("active"))&&($(this).parent().children("li").removeClass("active"),$(this).addClass("active"),$(this).closest(".block-sku").find(".PROP_"+s+" ~ .block-sku-detail-sku").find("li").hide().removeClass("active"),Offers.js_offers=JS_OFFERS,void Offers.OffersSelect(t,s))})});