!function(a){a.JCCatalogCompareList||(a.JCCatalogCompareList=function(a){this.obCompare=null,this.obAdminPanel=null,this.visual=a.VISUAL,this.visual.LIST=this.visual.ID+"_tbl",this.visual.ROW=this.visual.ID+"_row_",this.visual.COUNT=this.visual.ID+"_count",this.ajax=a.AJAX,BX.ready(BX.proxy(this.init,this))},a.JCCatalogCompareList.prototype.init=function(){this.obCompare=BX(this.visual.ID),this.obCompare&&(BX.addCustomEvent(a,"OnCompareChange",BX.proxy(this.reload,this)),BX.bindDelegate(this.obCompare,"click",{tagName:"a"},BX.proxy(this.deleteCompare,this)),$(document).on("show.bs.dropdown","#"+this.visual.ID,function(){$(this).removeClass("slideOutLeft").addClass("slideInLeft")}).on("hide.bs.dropdown","#"+this.visual.ID,function(){$(this).removeClass("slideInLeft").addClass("slideOutLeft")}).on("hidden.bs.dropdown","#"+this.visual.ID,function(){}).on("click.bs.dropdown.data-api","#"+this.visual.ID+" .dropdown-menu",function(a){a.stopPropagation()}))},a.JCCatalogCompareList.prototype.reload=function(){var a=new Loader;a.add($(this.obCompare)),BX.ajax.post(this.ajax.url,this.ajax.params,BX.proxy(this.reloadResult,this))},a.JCCatalogCompareList.prototype.reloadResult=function(a){this.obCompare.innerHTML=a,BX.style(this.obCompare,"display","block")},a.JCCatalogCompareList.prototype.deleteCompare=function(){var b,c,a=BX.proxy_context;if(a&&a.hasAttribute("data-id")&&(b=parseInt(a.getAttribute("data-id"),10),!isNaN(b))){var d=new Loader;d.add($(this.obCompare)),c=this.ajax.url+this.ajax.templates.delete+b.toString(),BX.ajax({url:c,data:this.ajax.params,dataType:"html",processData:!1,start:!0,onsuccess:function(a){d.end(),BX.onCustomEvent("OnCompareChange")}})}},a.JCCatalogCompareList.prototype.deleteCompareResult=function(a){var b,c,d,e,f;if(BX.closeWait(),"object"==typeof a&&a.STATUS&&"OK"===a.STATUS&&a.ID&&(b=BX(this.visual.LIST)))if(b.rows.length>1){for(d=this.visual.ROW+a.ID,c=0;c<b.rows.length;c++)b.rows[c].id===d&&b.deleteRow(c);b=null,a.COUNT&&(f=parseInt(a.COUNT,10),isNaN(f)||(e=BX(this.visual.COUNT),e&&(e.innerHTML=f.toString(),e=null),BX.style(this.obCompare,"display",f>0?"block":"none")))}else this.reload()})}(window);